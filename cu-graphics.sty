\NeedsTeXFormat{LaTeX2e}%
\RequirePackage{graphicx,pstricks}%
\ProvidesPackage{cu-graphics}[2017/03/12 v0.1 vector ornaments for Church Slavonic]%
%
\pst@addfams{cuGraphics}%
\pstheader{cu-graphics.pro}%
%
\newcommand*\cuGraphicsDefaultColor{black}%
%
\define@key[psset]{cuGraphics}{scale}{\def\@cuGraphicsBox##1{\scalebox{#1}{##1}}}%
\define@key[psset]{cuGraphics}{width}{%
 \def\@cuGraphicsWidth{#1}%
 \ifx\@cuGraphicsHeight\empty\def\@cuGraphicsxBox##1{\resizebox*{#1}{!}{##1}}%
 \else\def\@cuGraphicsBox##1{\resizebox*{#1}{\@cuGraphicsHeight}{##1}}%
 \fi
 }%
%
\define@key[psset]{cuGraphics}{height}{%
 \def\@cuGraphicsHeight{#1}%
 \ifx\@cuGraphicsWidth\empty\def\@cuGraphicsBox##1{\resizebox*{!}{#1}{##1}}%
 \else\def\@cuGraphicsBox##1{\resizebox*{\@cuGraphicsWidth}{#1}{##1}}%
 \fi}%
%
\define@key[psset]{cuGraphics}{color}{\def\@cuGraphicsColor{#1}}%
%
\define@key[psset]{cuGraphics}{opacity}{\def\@cuGraphicsOpacity{#1}}%%
%
\define@boolkey[psset]{cuGraphics}[Pst@]{flip}[true]{%
 \ifPst@flip\def\@cuGraphicsflip##1{\rotatebox{180}{\reflectbox{##1}}}%
 \else      \def\@cuGraphicsflip##1{##1}%
 \fi}%
%
\define@boolkey[psset]{cuGraphics}[Pst@]{mirror}[true]{%
 \ifPst@mirror\let\@cuGraphicsmirror\reflectbox%
 \else        \def\@cuGraphicsmirror##1{##1}%
 \fi}
%
\newcommand*\cuGraphics[2][]{%
\bgroup%
  \ifcsname cu@shape@body@#2\endcsname\relax\else
    \errmessage{Shape "#2" is not defined}%
  \fi%
  \def\@cuGraphicsWidth{}%
  \def\@cuGraphicsHeight{}%
  \psset[cuGraphics]{scale=1,opacity=1,color=\cuGraphicsDefaultColor,flip=false,mirror=false}{}%
  \ifx\relax#1\relax\else\psset[cuGraphics]{#1}\fi%
  \psset{linecolor=\@cuGraphicsColor,opacity=\@cuGraphicsOpacity}%
  \@cuGraphicsBox{\@cuGraphicsmirror{\@cuGraphicsflip{\@cuGraphicsDraw{#2}}}}%
\egroup%
}%
%
\def\pst@setColor{\pst@usecolor\pslinecolor}%
%
\def\cuDefineShape#1#2#3#4{%
\expandafter\def\csname cu@shape@width@#1\endcsname{#2}%
\expandafter\def\csname cu@shape@height@#1\endcsname{#3}%
\expandafter\def\csname cu@shape@body@#1\endcsname{#4}%
}%
%
\def\cu@shape@width#1{\csname cu@shape@width@#1\endcsname}
\def\cu@shape@height#1{\csname cu@shape@height@#1\endcsname}
\def\cu@shape@body#1{\csname cu@shape@body@#1\endcsname}%
%
\def\@cuGraphicsDraw#1{%
\psset{unit=1bp}%
\begin{pspicture}(0,0)(\cu@shape@width{#1},\cu@shape@height{#1})%
\begin@SpecialObj
\addto@pscode{
gsave
/fill \tx@setTransparency /fill load def
\cu@shape@body{#1}%
grestore
}
\end@SpecialObj
\end{pspicture}%
}%
%
%%% lets define few shapes here %%%
\cuDefineShape{triangle}{20}{20}{n 0 0 m 20 20 l 20 0 l h f}%
%
\endinput%
